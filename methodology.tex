\documentclass{article}
\usepackage{blindtext}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{color}


\begin{document}


\section{Methodology}\label{chapter:methodology}%Todo change into chapter
In this chapter, the simulator used to investigate the research questions is described. An overview of the system is presented in section \ref{section:systemt architecture}. Section \ref{section:genetic algorithm} includes implementation details, and design decisions made when implementing the genetic algorithm which is the foundation for all the population distributed genetic algorithms. Sections \ref{section:island model}-\ref{section:pool model} contains implementation details of the population distributed genetic algorithms. The wind scenarios used to evaluate the different population distributed genetic algorithm are described in section \ref{section:scenarios}, and the choice of implementing the genetic algorithm from scratch is defended in section \ref{section:motivation}.


\section{System Architecture}\label{section:systemt architecture}


\begin{figure}[h!]
\begin{center}
\includegraphics[scale=0.3]{images/"Class Diagram"}
\caption{Class Diagram.}
\label{figure:class diagram}
\end{center}
\end{figure}


The program is implemented in Java and the interactions between the different classes of the program are shown in figure \ref{figure:class diagram}. The GeneticAlgorithm class is extended by the three population distributed genetic algorithm classes: IslandModel, CellularModel and PoolModel. In addition, the GeneticAlgorithm class is also implemented as instances in all three population distributed algorithms. The main loop of the program is contained in the GeneticAlgorithm class. It uses instances of the classes WindScenario, WindFarmLayoutEvaluator, Population, AdultSelection, ParentSelection, Crossover and Mutation. AdultSelection, ParentSeleciton and Crossover are interfaces that needs to be implemented if new methods are to be added to the program. Mutation is a class containing four different mutation methods. 


\section{Genetic Algorithm}\label{section:genetic algorithm}
As mentioned in \textcolor{red}{reference chapter background}, the genetic algorithm consists of five steps: Adult selection, parent selection, recombination and fitness evaluation as shown in figure \ref{figure:genetic algorithm steps}. The implementation details of each step is described below.


\begin{figure}[h!]
\begin{center}
\includegraphics[scale=0.3]{images/"genetic algorithm steps"}
\caption{Genetic algorithm.}
\label{figure:genetic algorithm steps}
\end{center}
\end{figure}


\subsection{Adult Selection}\label{subsection:adult selection}
Adult selection is the process of selecting which individuals that are allowed to step into the adult pool and thereby become potential parents for the next generation of individuals. Three adult selection mechanisms were implemented in this thesis: Full generational replacement,  generational mixing, and overproduction. Each method was tested in order to decide which adult selection method was more suitable for solving the wind farm layout optimization problem. \\

\noindent Full generational replacement, is the simplest adult selection mechanism consisting of replacing all the individuals in the previous adult population with the newly generated child population. \\

\noindent The second method, generational mixing, is illustrated in figure \ref{figure:generational mixing}. As can be seen in the figure, the four best individuals (individuals with lowest fitness) from the pool consisting of all the newly generated children and the previous adult population are selected as the new adult population. \\


\begin{figure}[h!]
\begin{center}
\includegraphics[scale=0.2]{images/"adult selection"/"Generational Mixing"}
\caption{Generational mixing. The best individuals, those with lowest fitness, from the previous adult pool and the new child population are selected to represent the new adult pool.}
\label{figure:generational mixing}
\end{center}
\end{figure}


\noindent Overproduction, the third adult selection mechanism, is illustrated in figure \ref{figure:overproduction}. The newly generated child population consist of twice as many individuals than in the adult pool. Therefore, the child population have to compete against each other for the spots in the adult pool and only those with better fitness are able to survive. \\


\begin{figure}[h!]
\begin{center}
\includegraphics[scale=0.2]{images/"adult selection"/Overproduction}
\caption{Overproduction. The newly generated child population consist of twice as many individuals as there are room for in the adult population, therefore only the fittest individuals from the large child population grow up into adults.}
\label{figure:overproduction}
\end{center}
\end{figure}



\subsection{Parent Selection}\label{subsection:parent selection}
Parent selection is the selection of which adults become parents for the next child generation. When choosing parent selection method there are a few concerns that needs to be addressed. First, it is important that parents with good genes, i.e. higher fitness, gets their genes transferred to the next generation. However, it is also important to keep diversity in the population so that one does not end wit a sub-optimal solution; a local maxima. Two parent selection methods are implemented for the genetic algorithm: Tournament selection and roulette wheel selection. \\

\noindent In tournament selection, a given number of individuals are drawn randomly from the population. The number of individuals drawn is decided by the variable ''tournament size''. These individuals compete in a tournament for one spot in the parent pool. The individual with ''best'', i.e. lowest fitness is selected as a parent. These tournaments continue until the adult pool is full. Figure \ref{figure:tournament selection} shows how tournament selection works. As can be seen in the figure, three individuals are drawn randomly from the adult pool, meaning that the tournament size in this example is 3. The ''best'' individual, the individual with fitness 4 is the tournament winner and is allowed to enter the adult pool. \\


\begin{figure}[h!]
\begin{center}
\includegraphics[scale=0.2]{images/"Tournament Selection"}
\caption{Tournament selection.}
\label{figure:tournament selection}
\end{center}
\end{figure}


\noindent Different values of ''tournament size'' needs to be tested in order to find how settings that allow the algorithm to explore different solutions, but that also prioritize the best solutions. In chapter \textcolor{red}{reference results chapter}, results obtained for different tournament sizes are compared to find which is best for the wind farm layout optimization problem. \\


\noindent Roulette wheel selection assigns a probability of being chosen as parent to each individuals which is proportional to its fitness compared to all other solutions. Therefore, individuals with better fitness will be more likely to selected for the parent pool. Figure \ref{figure:roulette wheel selection} shows how roulette wheel selection works. The roulette wheel on the left shows the probability of each of the four individuals been selected. Since individual$_4$ has the best fitness, it has a larger probability of being selected than the others. \\


\begin{figure}[h!]
\begin{center}
\includegraphics[scale=0.5]{images/"roulette wheel selection"}
\caption{Roulette wheel selection. The roulette wheel is shown to the left, the four individuals to the right. Individual$_4$ has a four times better fitness than individual$_2$ and therefore has a four times larger probability of being selected.}
\label{figure:roulette wheel selection}
\end{center}
\end{figure}


\subsection{Genetic Operations}\label{subsection:genetic operations}


\subsubsection{Crossover and Elitism}


\subsubsection{Mutation}


\subsection{Wind-, Wake- and Power Model}\label{subsection:wind-, wake- and power model}


\subsection{Fitness Function}\label{subsection:fitness function}


\section{Island Model}\label{section:island model}


\section{Cellular Model}\label{section:cellular model}


\section{Pool Model}\label{section:pool model}


\section{Scenarios}\label{section:scenarios}


\section{Motivation}\label{section:motivation}


%\section{Evolutionary Algorithm}
%
%
%\subsection{Adult Selection}
%Adult selection is the process of selecting which individuals that are allowed to step into the adult pool and thereby become potential parents for the next generation of individuals. Three adult selection mechanisms were implemented in this thesis: (a) full generational replacement, (b) generational mixing, and (c) overproduction. Each method was tested in order to decide which adult selection method was more suitable for solving the wind farm layout optimization problem. Method (a), full generational replacement, is the simplest adult selection mechanism consisting of replacing all the individuals in the previous adult population with the newly generated child population. Method (b), generational mixing, is illustrated in figure \ref{figure:generational mixing}. As can be seen in the figure, the four best individuals (individuals with lowest fitness) from the pool consisting of all the newly generated children and the previous adult population are selected as the new adult population. Since individuals with better fitness is able to live a longer life, method (b) is a more realistic adult selection mechanism than full generational replacement. \\
%
%
%\begin{figure}[h!]
%\begin{center}
%\includegraphics[scale=0.15]{images/"adult selection"/"Generational Mixing"}
%\caption{Generational mixing. The best individuals, those with lowest fitness, from the previous adult pool and the new child population are selected to represent the new adult pool.}
%\label{figure:generational mixing}
%\end{center}
%\end{figure}
%
%
%\noindent Overproduction, adult selection method (c), is illustrated in figure \ref{figure:overproduction}. The newly generated child population consist of twice as many individuals than in the adult pool. Therefore, the child population have to compete against each other for the spots in the adult pool and only those with better fitness are able to survive. \\
%
%
%\begin{figure}[h!]
%\begin{center}
%\includegraphics[scale=0.15]{images/"adult selection"/Overproduction}
%\caption{Overproduction. The newly generated child population consist of twice as many individuals as there are room for in the adult population, therefore only the fittest individuals from the large child population grow up into adults.}
%\label{figure:overproduction}
%\end{center}
%\end{figure}
%
%
%\noindent \textcolor{red}{Include results from adult selection tests and explain which was selected for this thesis and why}
%
%
%\subsection{Parent Selection}
%\textcolor{red}{Implement and test different parent selection mechanism and explain which is selected for this thesis and why.}
%
%
%\subsection{Reproduction}
%After the parent selection process is finished, a new child population is made from those individuals. One distinguishes between asexual and sexual reproduction. In genetic algorithms sexual reproduction is performed using crossover methods, meaning that the genotypes of two parent individuals are recombined to form two child individuals. Asexual reproduction usually is performed by copying parent individuals into the child pool. Different reproduction- and genetic operations that was implemented and tested in this thesis is described below.
%
%
%\subsubsection{Crossover and Elitism}
%Three crossover methods was implemented and tested in this thesis. The methods used are (a) single point crossover, (b) two point crossover and (c) uniform crossover. Figure \ref{figure:crossover methods} displays the different methods. Method (a), single point crossover is shown in figure \ref{figure:single point crossover}. A random position between two genes is drawn as the crossover point. In the figure the point between genes 4 and 5 is picked as the crossover point. Therefore the first child gets its first four genes from parent 1 and its next four genes from parent two, and child two gets the opposite genes. Method (b), two point crossover, is displayed in figure \ref{figure:two point crossover} and works in the same way as single point crossover except that there are two crossover points instead of one. Last, uniform crossover (c) works by tossing a coin for each gene of the individuals, thereby there is a 50 percent probability that each gene of the child will be drawn from each parent. This is shown in figure \ref{figure:uniform crossover}. \\
%
%
%\begin{figure}
%    \centering
%    \begin{subfigure}[b]{0.3\textwidth}
%        \includegraphics[width=\textwidth]{images/crossover/"Single point crossover"}
%        \caption{Single point crossover.}
%        \label{figure:single point crossover}
%    \end{subfigure}
%    ~ 
%    \begin{subfigure}[b]{0.3\textwidth}
%        \includegraphics[width=\textwidth]{images/crossover/"Two point crossover"}
%        \caption{Two point crossover.}
%        \label{figure:two point crossover}
%    \end{subfigure}
%    ~
%    \begin{subfigure}[b]{0.3\textwidth}
%        \includegraphics[width=\textwidth]{images/crossover/"Uniform crossover"}
%        \caption{Uniform crossover.}
%        \label{figure:uniform crossover}
%    \end{subfigure}
%    \caption{Crossover methods.}\label{figure:crossover methods}
%\end{figure}
%
%
%\noindent The crossover probability decides the percentage of children that are generated with sexual reproduction; crossover methods. Individuals generated with asexual reproduction are simply parent genotypes copied into the child pool. However, they might end up slightly different than their parents because of mutation which will be discussed in the next section. \\
%
%
%\noindent Elitism is the process of letting the best individual of the parent population survive, meaning that the best parent individual is simply copied into the child pool. Elitism usually lead to better results for genetic algorithms and is also implemented in this thesis. \\
%
%
%\noindent \textcolor{red}{Discuss findings and disisions about crossover method, rate, and elitism.}
%
%
%\subsubsection{Mutation}
%
%
%
\end{document}